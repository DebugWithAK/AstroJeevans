{"ast":null,"code":"import { firebase, auth, db } from \"../config/firebase\";\n\nfunction updateUser({\n  email,\n  name,\n  surname,\n  phoneNumber,\n  photo,\n  finalEvent\n}) {\n  const currentUser = auth.currentUser.uid;\n\n  if (photo) {\n    return firebase.storage().ref(\"images/\" + currentUser + ((photo === null || photo === void 0 ? void 0 : photo.name) || \"0\")).put(photo).then(doc => {\n      doc.ref.getDownloadURL().then(url => {\n        db.collection(\"Users\").doc(currentUser).update({\n          name,\n          surname,\n          email,\n          phoneNumber: phoneNumber || \"\",\n          photoUrl: url\n        }).catch(e => console.log(e)).finally(() => finalEvent());\n      });\n    }).catch(e => console.log(e));\n  }\n\n  return db.collection(\"Users\").doc(currentUser).update({\n    name,\n    surname,\n    email,\n    phoneNumber: phoneNumber || \"\"\n  });\n}\n\nfunction updatePassword({\n  currentPassword,\n  newPassword\n}) {\n  const currentUser = auth.currentUser;\n  const credential = firebase.auth.EmailAuthProvider.credential(firebase.auth().currentUser.email, currentPassword);\n\n  const update = () => {\n    return currentUser.updatePassword(newPassword).then(function () {// Update successful.\n    }).catch(function (error) {// An error happened.\n    });\n  };\n\n  const reauth = () => {\n    return currentUser.reauthenticateWithCredential(credential);\n  };\n\n  return {\n    reauth,\n    update\n  };\n}\n\nexport { updateUser, updatePassword };","map":{"version":3,"sources":["C:/Users/ASUS/Desktop/ASTRO/firebase/update-user.js"],"names":["firebase","auth","db","updateUser","email","name","surname","phoneNumber","photo","finalEvent","currentUser","uid","storage","ref","put","then","doc","getDownloadURL","url","collection","update","photoUrl","catch","e","console","log","finally","updatePassword","currentPassword","newPassword","credential","EmailAuthProvider","error","reauth","reauthenticateWithCredential"],"mappings":"AAAA,SAASA,QAAT,EAAmBC,IAAnB,EAAyBC,EAAzB,QAAmC,oBAAnC;;AAEA,SAASC,UAAT,CAAoB;AAAEC,EAAAA,KAAF;AAASC,EAAAA,IAAT;AAAeC,EAAAA,OAAf;AAAwBC,EAAAA,WAAxB;AAAqCC,EAAAA,KAArC;AAA4CC,EAAAA;AAA5C,CAApB,EAA8E;AAC5E,QAAMC,WAAW,GAAGT,IAAI,CAACS,WAAL,CAAiBC,GAArC;;AAEA,MAAIH,KAAJ,EAAW;AACT,WAAOR,QAAQ,CACZY,OADI,GAEJC,GAFI,CAEA,YAAYH,WAAZ,IAA2B,CAAAF,KAAK,SAAL,IAAAA,KAAK,WAAL,YAAAA,KAAK,CAAEH,IAAP,KAAe,GAA1C,CAFA,EAGJS,GAHI,CAGAN,KAHA,EAIJO,IAJI,CAIEC,GAAD,IAAS;AACbA,MAAAA,GAAG,CAACH,GAAJ,CAAQI,cAAR,GAAyBF,IAAzB,CAA+BG,GAAD,IAAS;AACrChB,QAAAA,EAAE,CAACiB,UAAH,CAAc,OAAd,EACGH,GADH,CACON,WADP,EAEGU,MAFH,CAEU;AACNf,UAAAA,IADM;AAENC,UAAAA,OAFM;AAGNF,UAAAA,KAHM;AAING,UAAAA,WAAW,EAAEA,WAAW,IAAI,EAJtB;AAKNc,UAAAA,QAAQ,EAAEH;AALJ,SAFV,EASGI,KATH,CASUC,CAAD,IAAOC,OAAO,CAACC,GAAR,CAAYF,CAAZ,CAThB,EAUGG,OAVH,CAUW,MAAMjB,UAAU,EAV3B;AAWD,OAZD;AAaD,KAlBI,EAmBJa,KAnBI,CAmBGC,CAAD,IAAOC,OAAO,CAACC,GAAR,CAAYF,CAAZ,CAnBT,CAAP;AAoBD;;AAED,SAAOrB,EAAE,CACNiB,UADI,CACO,OADP,EAEJH,GAFI,CAEAN,WAFA,EAGJU,MAHI,CAGG;AACNf,IAAAA,IADM;AAENC,IAAAA,OAFM;AAGNF,IAAAA,KAHM;AAING,IAAAA,WAAW,EAAEA,WAAW,IAAI;AAJtB,GAHH,CAAP;AASD;;AAED,SAASoB,cAAT,CAAwB;AAAEC,EAAAA,eAAF;AAAmBC,EAAAA;AAAnB,CAAxB,EAA0D;AACxD,QAAMnB,WAAW,GAAGT,IAAI,CAACS,WAAzB;AAEA,QAAMoB,UAAU,GAAG9B,QAAQ,CAACC,IAAT,CAAc8B,iBAAd,CAAgCD,UAAhC,CACjB9B,QAAQ,CAACC,IAAT,GAAgBS,WAAhB,CAA4BN,KADX,EAEjBwB,eAFiB,CAAnB;;AAKA,QAAMR,MAAM,GAAG,MAAM;AACnB,WAAOV,WAAW,CACfiB,cADI,CACWE,WADX,EAEJd,IAFI,CAEC,YAAY,CAChB;AACD,KAJI,EAKJO,KALI,CAKE,UAAUU,KAAV,EAAiB,CACtB;AACD,KAPI,CAAP;AAQD,GATD;;AAWA,QAAMC,MAAM,GAAG,MAAM;AACnB,WAAOvB,WAAW,CAACwB,4BAAZ,CAAyCJ,UAAzC,CAAP;AACD,GAFD;;AAIA,SAAO;AACLG,IAAAA,MADK;AAELb,IAAAA;AAFK,GAAP;AAID;;AAED,SAASjB,UAAT,EAAqBwB,cAArB","sourcesContent":["import { firebase, auth, db } from \"../config/firebase\";\n\nfunction updateUser({ email, name, surname, phoneNumber, photo, finalEvent }) {\n  const currentUser = auth.currentUser.uid;\n\n  if (photo) {\n    return firebase\n      .storage()\n      .ref(\"images/\" + currentUser + (photo?.name || \"0\"))\n      .put(photo)\n      .then((doc) => {\n        doc.ref.getDownloadURL().then((url) => {\n          db.collection(\"Users\")\n            .doc(currentUser)\n            .update({\n              name,\n              surname,\n              email,\n              phoneNumber: phoneNumber || \"\",\n              photoUrl: url,\n            })\n            .catch((e) => console.log(e))\n            .finally(() => finalEvent());\n        });\n      })\n      .catch((e) => console.log(e));\n  }\n\n  return db\n    .collection(\"Users\")\n    .doc(currentUser)\n    .update({\n      name,\n      surname,\n      email,\n      phoneNumber: phoneNumber || \"\",\n    });\n}\n\nfunction updatePassword({ currentPassword, newPassword }) {\n  const currentUser = auth.currentUser;\n\n  const credential = firebase.auth.EmailAuthProvider.credential(\n    firebase.auth().currentUser.email,\n    currentPassword\n  );\n\n  const update = () => {\n    return currentUser\n      .updatePassword(newPassword)\n      .then(function () {\n        // Update successful.\n      })\n      .catch(function (error) {\n        // An error happened.\n      });\n  };\n\n  const reauth = () => {\n    return currentUser.reauthenticateWithCredential(credential);\n  };\n\n  return {\n    reauth,\n    update,\n  };\n}\n\nexport { updateUser, updatePassword };\n"]},"metadata":{},"sourceType":"module"}